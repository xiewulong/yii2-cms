/*!
 * backend minify
 * xiewulong <xiewulong@vip.qq.com>
 * create: 2016/8/8
 * since: 0.0.1
 */
"use strict";function _classCallCheck(t,s){if(!(t instanceof s))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function t(t,s){for(var a=0;a<s.length;a++){var e=s[a];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}return function(s,a,e){return a&&t(s.prototype,a),e&&t(s,e),s}}();!function(t,s,a,e){t(a).on("click","[data-user=logout] a.text",function(){var a=t(this).parents(".dropdown-open").removeClass("dropdown-open").end();return t.ajax({url:a.attr("href"),data:t.csrf(),method:"post",success:function(t){return t.error?(console.error(t.message),!1):void s.location.reload()}}),!1})}(jQuery,window,document),function(t,s,a,e){t(a).on("click","[data-password=reset] a.text",function(s){var a=t(this).parents(".dropdown-open").removeClass("dropdown-open").end(),e=t.modal('<div class="modal fade"><div class="modal-dialog"><form class="modal-content form-horizontal"><fieldset><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h5 class="modal-title">'+a.text()+'</h5></div><div class="modal-body"><div class="form-group"><label class="col-sm-3 control-label" for="password-old">原密码</label><div class="col-sm-6"><input type="password" name="password_old" id="password-old" class="form-control" autofocus="autofocus" /></div></div><div class="form-group"><label class="col-sm-3 control-label" for="password">新密码</label><div class="col-sm-6"><input type="password" name="password" id="password" class="form-control" /></div></div><div class="form-group"><label class="col-sm-3 control-label" for="password-repeat">确认新密码</label><div class="col-sm-6"><input type="password" name="password_repeat" id="password-repeat" class="form-control" /></div></div></div><div class="modal-footer"><button type="button" class="btn btn-default" data-dismiss="modal">取消</button><button type="submit" class="btn btn-primary">确定</button></div></fieldset></form></div></div>');return e.on("submit","form",function(){var s=void 0,i=void 0,o=t(this).find("fieldset").prop("disabled",!0),l={password_old:this.password_old.value,password:this.password.value,password_repeat:this.password_repeat.value};return""==l.password_old?(s=this.password_old,i="请输入原密码"):""==l.password?(s=this.password,this.password.focus(),i="请输入新密码"):""==l.password_repeat?(s=this.password_repeat,i="请确认新密码"):l.password!=l.password_repeat&&(s=this.password_repeat,i="两次输入的新密码不一致"),i?(o.prop("disabled",!1),s.focus(),!1):(t.ajax({url:a.attr("href"),data:t.csrf({User:l}),method:"post",dataType:"json",success:function(s){s.error?o.prop("disabled",!1):e.modal("hide"),t.alert(s.message,s.error)}}),!1)}),!1})}(jQuery,window,document),function(t,s){var a=function(){function s(a,e,i,o,l,r){return _classCallCheck(this,s),this.$target=a,this.unsupportList=e,this.value=i,this.parentItems=l,this.parentItemsValue=r,this.$formGroups=t(".form-group"),o&&(this.$static=t(o),this.value=""==this.value?this.$target.val():this.value),this.init()}return _createClass(s,[{key:"init",value:function(){return this.events(),this.switch(),this.$target}},{key:"events",value:function(){var t=this;this.$target.on("change",function(){t.value=this.value,t.switch()})}},{key:"switch",value:function(){var t=void 0,s=void 0;this.$static&&(s=this.parentItems[this.value],this.$static.html(this.parentItemsValue[s]||""),this.value=s),t=this.unsupportList[this.value]||[],this.$formGroups.show(),t.length&&this.$formGroups.filter("."+t.join(", .")).hide()}}]),s}();t.fn.radioFormSwitch=function(t,s,e,i,o){return new a(this,t,s,e,i,o)},t.fn.formSwitch=function(t,s,a,e,i){var o=this.attr("data-form-switch");return this[o+"FormSwitch"]?this[o+"FormSwitch"](t,s,a,e,i):this}}(jQuery),function(t,s,a){var e=t(s),i=function(){function s(a){return _classCallCheck(this,s),this.$button=t(a),this.$formGroup=this.$button.parents(".form-group"),this.$label=this.$formGroup.find("label"),this.$hidden=this.$formGroup.find("input[type=hidden]"),this.$name=this.$formGroup.find("span"),this.url=this.$button.attr("data-form-selection"),this._value=this.$hidden.val(),this.init()}return _createClass(s,[{key:"init",value:function(){this.getData(),this.modal(),this.events()}},{key:"events",value:function(){var s=this;this.$modal.on("click","ul li p",function(){var a=t(this);return a.next("ul").length?(a.parent("li").toggleClass("unfold"),!1):!a.hasClass("active")&&(s.value=a.attr("data-id"),s.name=a.attr("data-name"),s.setValue(),!1)}),this.$name.on("click","i",function(){s.clearAll()})}},{key:"setValue",value:function(){this.$hidden.val(this.value),this.$name.html((this.$button.attr("data-form-selected-clear")?'<i class="glyphicon glyphicon-remove" data-form-selected="clear"></i>':"")+this.name),this.close()}},{key:"close",value:function(){this.$modal.modal("hide")}},{key:"modal",value:function(){var s='<div class="modal fade"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h5 class="modal-title">'+this.$label.text()+'</h5></div><div class="modal-body admin-selection admin-loading"></div></div></div></div>';this.$modal=t.modal(s),this.setData()}},{key:"setData",value:function(){var t=this,s=void 0,a=void 0;!this.loaded&&this.data&&(this.loaded=!0,a=(s=function(a){for(var e=void 0,i=0,o=a.length,l=["<ul>"];i<o;i++){var r=void 0;e=a[i],r=e.children||e.items,l.push("<li><p"+(!r&&t._value&&e.id==t._value?' class="active"':"")+' data-id="'+e.id+'" data-name="'+e.name+'">'+(r?'<i class="glyphicon glyphicon-triangle-bottom"></i>':"")+e.name+"</p>"),e.children&&l.push(s(e.children)),e.items&&l.push(s(e.items)),l.push("</li>")}return l.push("</ul>"),l.join("")})(this.data),this.$modal.find(".admin-loading").removeClass("admin-loading").html(a))}},{key:"getData",value:function(){var s=this;t.ajax({url:this.url,data:{},method:"get",dataType:"json",success:function(a){a.error&&t.alert(a.message),s.data=a.data,s.setData()}})}}]),s}();e.on("click","[data-form-selection]",function(){new i(this)}).on("click","[data-form-selected=clear]",function(){var s=t(this);s.parent(".selection-name").html("").prevAll("input[type=hidden]").val("")})}(jQuery,document);
//# sourceMappingURL=backend.min.js.map
